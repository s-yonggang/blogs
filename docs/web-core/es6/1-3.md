# å­—ç¬¦ä¸²æ‹“å±•

## å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•
- ES6 åŠ å¼ºäº†å¯¹ Unicode çš„æ”¯æŒï¼Œå…è®¸é‡‡ç”¨`\uxxxx`å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­xxxxè¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚
- åªé™äºç ç‚¹åœ¨`\u0000~\uFFFF`ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ª`åŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤º`ï¼Œæˆ–è€…å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚
```javascript
// ä½¿ç”¨ Unicode è¡¨ç¤º "ğ ®·"
"\u20BB7" // " 7" ç›´æ¥ä½¿ç”¨ Ã— 
"\uD842\uDFB7" // "ğ ®·" ä½¿ç”¨åŒå­—èŠ‚ âˆš 
"\u{20BB7}" // "ğ ®·" ä½¿ç”¨ {} âˆš 
```
> ä¸Šé¢ç¤ºä¾‹ "ğ ®·" çš„è¡¨ç¤ºæ–¹å¼ï¼Œç”±äº`20BB7` å¤§äº `FFFF`ï¼Œjavascriptä¼šç†è§£æˆ`\u20BB+7`ï¼Œè€Œ`\u20BB`æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª 7ã€‚

## å­—ç¬¦åŠå­—ç¬¦è½¬ä¹‰
- JavaScriptå­—ç¬¦ä¸²å…è®¸ç›´æ¥è¾“å…¥å­—ç¬¦ï¼Œæˆ–è€…å­—ç¬¦çš„è½¬ä¹‰å½¢å¼ï¼Œä¸¤è€…æ˜¯ç­‰ä»·çš„ã€‚å¦‚ï¼š` 'ä¸­' === '\u4e2d' `
- JavaScript è§„å®šæœ‰5ä¸ªå­—ç¬¦ï¼Œä¸èƒ½åœ¨å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨è½¬ä¹‰å½¢å¼ã€‚
  - U+005Cï¼šåæ–œæ ï¼ˆreverse solidusï¼‰
  - U+000Dï¼šå›è½¦ï¼ˆcarriage returnï¼‰
  - U+2028ï¼šè¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰
  - U+2029ï¼šæ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰
  - U+000Aï¼šæ¢è¡Œç¬¦ï¼ˆline feedï¼‰

å­—ç¬¦ä¸²é‡Œé¢ä¸èƒ½ç›´æ¥åŒ…å«åæ–œæ ï¼ˆè¢«è½¬ä¹‰ï¼Œå¾—ä¸åˆ°æƒ³è¦çš„ç»“æœï¼Œæˆ–è€…æŠ¥é”™ï¼‰ï¼Œä¸€å®šè¦è½¬ä¹‰å†™æˆ`\\`æˆ–è€…`\u005c`ã€‚

:::info æ³¨æ„
1. JSON æ ¼å¼å…è®¸å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒæœåŠ¡å™¨è¾“å‡ºçš„ JSON è¢«JSON.parseè§£æï¼Œå°±æœ‰å¯èƒ½ç›´æ¥æŠ¥é”™ã€‚

2. åœ¨ES2019 å…è®¸ JavaScript å­—ç¬¦ä¸²ç›´æ¥è¾“å…¥ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚

3. ä½†æ­£åˆ™è¡¨è¾¾å¼ä¾ç„¶ä¸å…è®¸ç›´æ¥è¾“å…¥ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚
:::

## JSON.stringify()
**å­˜åœ¨é—®é¢˜**

æ ¹æ®æ ‡å‡†ï¼ŒJSON æ•°æ®å¿…é¡»æ˜¯ UTF-8 ç¼–ç ã€‚ä½†æ˜¯ï¼Œç°åœ¨çš„JSON.stringify()æ–¹æ³•æœ‰å¯èƒ½è¿”å›ä¸ç¬¦åˆ UTF-8 æ ‡å‡†çš„å­—ç¬¦ä¸²ã€‚
> UTF-8 æ ‡å‡†è§„å®šï¼Œ0xD800åˆ°0xDFFFä¹‹é—´çš„ç ç‚¹ï¼Œä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…å¯¹ä½¿ç”¨ã€‚
æ¯”å¦‚ï¼Œ\uD834\uDF06æ˜¯ä¸¤ä¸ªç ç‚¹ï¼Œä½†æ˜¯å¿…é¡»æ”¾åœ¨ä¸€èµ·é…å¯¹ä½¿ç”¨ï¼Œä»£è¡¨å­—ç¬¦ğŒ†ã€‚è¿™æ˜¯ä¸ºäº†è¡¨ç¤ºç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦çš„ä¸€ç§å˜é€šæ–¹æ³•ã€‚å•ç‹¬ä½¿ç”¨\uD834å’Œ\uDFO6è¿™ä¸¤ä¸ªç ç‚¹æ˜¯ä¸åˆæ³•çš„ï¼Œæˆ–è€…é¢ å€’é¡ºåºä¹Ÿä¸è¡Œå› ä¸º\uDF06\uD834å¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ã€‚ 

**è§£å†³æ–¹æ¡ˆ**

ES2019 æ”¹å˜äº†JSON.stringify()çš„è¡Œä¸ºï¼Œç¡®ä¿è¿”å›æ˜¯åˆæ³•çš„ UTF-8 å­—ç¬¦ã€‚
> å¦‚æœé‡åˆ°0xD800åˆ°0xDFFFä¹‹é—´çš„å•ä¸ªç ç‚¹ï¼Œæˆ–è€…ä¸å­˜åœ¨çš„é…å¯¹å½¢å¼ï¼Œå®ƒä¼šè¿”å›è½¬ä¹‰å­—ç¬¦ä¸²ï¼Œç•™ç»™åº”ç”¨è‡ªå·±å†³å®šä¸‹ä¸€æ­¥çš„å¤„ç†ã€‚
```javascript
JSON.stringify('\u{D834}') // ""\\uD834""
JSON.stringify('\uDF06\uD834') // ""\\udf06\\ud834""
```

## æ¨¡æ¿å­—ç¬¦ä¸²

æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å· ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚
```javascript
`string text`
`string text line 1
 string text line 2`
`string text ${expression} string text`
tagFunction`string text ${expression} string text`
```
- é€šè¿‡ä½¿ç”¨å ä½ç¬¦ ${expression} åµŒå…¥å¾…æ›¿æ¢çš„è¡¨è¾¾å¼ï¼Œå¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„ JavaScript è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚è¡¨è¾¾å¼æ‰§è¡Œå®Œæˆåšï¼Œå¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚
- è‹¥è¦è½¬ä¹‰æ¨¡æ¿å­—é¢é‡ä¸­çš„åå¼•å·ï¼ˆ`ï¼‰ï¼Œéœ€åœ¨åå¼•å·ä¹‹å‰åŠ ä¸€ä¸ªåæ–œæ ï¼ˆ\ï¼‰ã€‚
- å­—ç¬¦ä¸²å­—é¢é‡ä¸­çš„è½¬ä¹‰åºåˆ—éƒ½æ˜¯å…è®¸çš„ï¼Œä»»ä½•å…¶ä»–æ ¼å¼ä¸æ­£ç¡®çš„è½¬ä¹‰åºåˆ—éƒ½æ˜¯è¯­æ³•é”™è¯¯ã€‚
    > \ åè·Ÿ 0 ä»¥å¤–çš„ä»»ä½•åè¿›åˆ¶æ•°å­—ï¼Œè¯­æ³•æŠ¥é”™ï¼›<br />
    > \x åè·Ÿä¸¤ä½ä»¥ä¸‹åå…­è¿›åˆ¶æ•°å­—ï¼Œè¯­æ³•æŠ¥é”™ï¼›<br />
    > \u åä¸è·Ÿ {}ï¼Œå¹¶ä¸”åè·Ÿå››ä¸ªä»¥ä¸‹åå…­è¿›åˆ¶æ•°å­—ï¼Œè¯­æ³•æŠ¥é”™ï¼›
    

### æ¨¡æ¿ç¼–è¯‘
é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”Ÿæˆæ­£å¼æ¨¡æ¿çš„å®ä¾‹ã€‚
```javascript
let template = `
<ul>
  <% for(let i=0; i < data.supplies.length; i++) { %>
    <li><%= data.supplies[i] %></li>
  <% } %>
</ul>
`;
```
è¯¥æ¨¡æ¿ä½¿ç”¨`<%...%>`æ”¾ç½® JavaScript ä»£ç ï¼Œä½¿ç”¨`<%= ... %>`è¾“å‡º JavaScript è¡¨è¾¾å¼ã€‚
```javascript
// compile å°è£…
function compile(template){
  const evalExpr = /<%=(.+?)%>/g;
  const expr = /<%([\s\S]+?)%>/g;
  template = template
    .replace(evalExpr, '`); \n  echo( $1 ); \n  echo(`')
    .replace(expr, '`); \n $1 \n  echo(`');
  template = 'echo(`' + template + '`);';
  let script =
  `(function parse(data){
    let output = "";
    function echo(html){
      output += html;
    }
    ${ template }
    return output;
  })`;
  return script;
}
```
è°ƒç”¨ compile å‡½æ•°
```javascript
let parse = eval(compile(template));
div.innerHTML = parse({ supplies: [ "broom", "mop", "cleaner" ] });
//   <ul>
//     <li>broom</li>
//     <li>mop</li>
//     <li>cleaner</li>
//   </ul>

// eval å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„å‡½æ•°
```

## æ ‡ç­¾æ¨¡æ¿
æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ã€‚è¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸º `æ ‡ç­¾æ¨¡æ¿` åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚
```javascript
alert`hello`
// ç­‰åŒäº
alert(['hello'])
```
æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°ã€‚
- å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†ï¼›
- æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚
    > å‡½æ•°å‚æ•°ï¼š<br />
    > ç¬¬ä¸€ä¸ªå‚æ•°ï¼š[ ] ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†<br />
    > åé¢çš„å‚æ•°: ...restï¼Œæ˜¯${...} è¡¨è¾¾å¼çš„å€¼<br />

```javascript
let a = 5;
let b = 10;
function tag(s, v1, v2) {
  console.log(s[0]);
  console.log(s[1]);
  console.log(s[2]);
  console.log(v1);
  console.log(v2);
  return "OK";
}
tag`Hello ${ a + b } world ${ a * b}`;
// "Hello "
// " world "
// ""
// 15
// 50
// "OK" è¿™æ˜¯å‡½æ•°è¿”å›å€¼
```

**æ ‡ç­¾æ¨¡æ¿çš„åº”ç”¨**:
- å°±æ˜¯è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚
- å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚
- jsxå‡½æ•°å°è£…ç­‰ç­‰ã€‚

## å­—ç¬¦æ–°å¢æ–¹æ³•
**é™æ€æ–¹æ³•**ï¼š
- String.fromCodePoint()
- String.raw()

**å®ä¾‹æ–¹æ³•**ï¼š
- String.prototype.codePointAt()
- String.prototype.normalize()
- String.prototype.includes()
- String.prototype.startsWith()
- String.prototype.endsWith()
- String.prototype.replace()
- String.prototype.padStart()
- String.prototype.padEnd()
- String.prototype.trimStart()
- String.prototype.trimEnd()
- String.prototype.matchAll()
